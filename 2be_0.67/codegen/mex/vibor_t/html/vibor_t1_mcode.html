<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">ndt</span>,<span class="var type1" id="S3T1U4">j_ndt</span>,<span class="var type1" id="S4T16U5">fl1</span>]=vibor_t(<span class="mxinfo" id="T1:U4"><span class="mxinfo" id="T1:U5"><span class="var type1" id="S2T1U8">ndt</span></span></span>,<span class="var type1" id="S5T1U9">fl</span>,<span class="var type1" id="S6T6U10">Pc</span>,<span class="var type1" id="S7T6U11">Pg</span>,<span class="var type1" id="S8T6U12">Pw</span>,<span class="var type1" id="S9T2U13">PR</span>,<span class="var type1" id="S10T7U14">RC</span>,<span class="var type1" id="S11T1U15">dt</span>,<span class="var type1" id="S12T6U16">Sw1</span>,<span class="var type1" id="S13T6U17">Sw2</span>,<span class="var type1" id="S14T6U18">CL</span>,<span class="var type1" id="S15T9U19">GL</span>,<span class="var type1" id="S16T6U20">dVc</span>,<span class="var type1" id="S17T6U21">dVg</span>,<span class="var type1" id="S18T6U22">W1C</span>,<span class="var type1" id="S19T6U23">W1G</span>,<span class="var type1" id="S20T10U24">WoC</span>,<span class="var type1" id="S21T10U25">WoG</span>,<span class="var type1" id="S22T1U26">i</span>,<span class="mxinfo" id="T1:U25"><span class="mxinfo" id="T1:U26"><span class="var type1" id="S3T1U27">j_ndt</span></span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line"><span class="mxinfo" id="T1:U28"><span class="var type1" id="S23T1U30">Fc</span>=<span class="mxinfo" id="T1:U30"><span class="var type1" id="S9T2U32">PR</span>.Fc2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line"><span class="mxinfo" id="T1:U32"><span class="var type1" id="S24T1U36">Sc</span>=<span class="mxinfo" id="T1:U34"><span class="var type1" id="S9T2U38">PR</span>.Sc2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line"><span class="mxinfo" id="T6:U36"><span class="var type1" id="S25T6U42">dPc</span>=<span class="mxinfo" id="T6:U38"><span class="mxinfo" id="T6:U39"><span class="var type1" id="S6T6U45">Pc</span>(<span class="mxinfo" id="T6:U41"><span class="var type1" id="S10T7U47">RC</span>.Cc</span>)</span>-<span class="mxinfo" id="T6:U43"><span class="var type1" id="S6T6U50">Pc</span>(<span class="mxinfo" id="T6:U45"><span class="var type1" id="S10T7U52">RC</span>.Cr</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo" id="T9:U47"><span class="var type1" id="S26T9U56">dPg</span>=<span class="mxinfo" id="T9:U49"><span class="mxinfo" id="T9:U50"><span class="var type1" id="S7T6U59">Pg</span>(<span class="mxinfo" id="T9:U52"><span class="var type1" id="S10T7U61">RC</span>.Gc</span>)</span>-<span class="mxinfo" id="T9:U54"><span class="var type1" id="S7T6U64">Pg</span>(<span class="mxinfo" id="T9:U56"><span class="var type1" id="S10T7U66">RC</span>.Gr</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line"><span class="mxinfo" id="T6:U58"><span class="var type1" id="S27T6U70">dPwc</span>=<span class="mxinfo" id="T6:U60"><span class="mxinfo" id="T6:U61"><span class="var type1" id="S6T6U73">Pc</span>(<span class="mxinfo" id="T6:U63"><span class="var type1" id="S20T10U75">WoC</span>(:,<span class="mxinfo" id="T1:U65">1</span>)</span>)</span>-<span class="mxinfo" id="T6:U66"><span class="var type1" id="S8T6U79">Pw</span>(<span class="mxinfo" id="T6:U68"><span class="var type1" id="S20T10U81">WoC</span>(:,<span class="mxinfo" id="T1:U70">3</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo" id="T6:U71"><span class="var type1" id="S28T6U86">dPwg</span>=<span class="mxinfo" id="T6:U73"><span class="mxinfo" id="T6:U74"><span class="var type1" id="S7T6U89">Pg</span>(<span class="mxinfo" id="T6:U76"><span class="var type1" id="S21T10U91">WoG</span>(:,<span class="mxinfo" id="T1:U78">1</span>)</span>)</span>-<span class="mxinfo" id="T6:U79"><span class="var type1" id="S8T6U95">Pw</span>(<span class="mxinfo" id="T6:U81"><span class="var type1" id="S21T10U97">WoG</span>(:,<span class="mxinfo" id="T1:U83">3</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line"><span class="mxinfo" id="T20:U84"><span class="var type1" id="S29T20U102">v1</span>=<span class="mxinfo" id="T20:U86"><span class="var type1" id="S25T6U104">dPc</span>&gt;<span class="mxinfo" id="T1:U88">0</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line"><span class="mxinfo" id="T26:U89"><span class="var type1" id="S30T26U108">v2</span>=<span class="mxinfo" id="T26:U91"><span class="var type1" id="S26T9U110">dPg</span>&gt;<span class="mxinfo" id="T1:U93">0</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line"><span class="keyword">if</span>  <span class="mxinfo" id="T16:U94"><span class="var type1" id="S5T1U115">fl</span>==<span class="mxinfo" id="T1:U96">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line">  <span class="keyword">if</span> (<span class="mxinfo" id="T16:U97"><span class="mxinfo" id="T1:U98">min(<span class="var type1" id="S12T6U124">Sw1</span>)</span>&gt;<span class="var type1" id="S24T1U125">Sc</span></span>) &amp;&amp; (<span class="mxinfo" id="T16:U101"><span class="var type1" id="S22T1U128">i</span>~=<span class="mxinfo" id="T1:U103">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line">    <span class="mxinfo" id="T6:U104"><span class="var type1" id="S32T6U132">MdS</span>=<span class="mxinfo" id="T6:U106">abs((<span class="mxinfo" id="T6:U107"><span class="var type1" id="S13T6U137">Sw2</span>-<span class="var type1" id="S12T6U138">Sw1</span></span>))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line">    <span class="mxinfo" id="T20:U110"><span class="var type1" id="S34T20U141">nf</span>=(<span class="mxinfo" id="T20:U112"><span class="mxinfo" id="T20:U113">isnan(<span class="var type1" id="S32T6U146">MdS</span>)</span>==<span class="mxinfo" id="T1:U115">0</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line">    <span class="mxinfo" id="T1:U116"><span class="var type1" id="S36T1U150">dS</span>=<span class="mxinfo" id="T1:U118">max(<span class="mxinfo" id="T6:U119"><span class="var type1" id="S32T6U154">MdS</span>(<span class="mxinfo" id="T20:U121"><span class="var type1" id="S34T20U156">nf</span>==<span class="mxinfo" id="T1:U123">1</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line">    <span class="mxinfo" id="T1:U124"><span class="var type1" id="S38T1U160">new_dt</span>=<span class="mxinfo" id="T1:U126"><span class="var type1" id="S36T1U162">dS</span>/<span class="mxinfo" id="T1:U128">0.02</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line">    <span class="mxinfo" id="T1:U129"><span class="var type1" id="S2T1U166">ndt</span>=<span class="mxinfo" id="T1:U131">ceil(<span class="mxinfo" id="T1:U132"><span class="var type1" id="S2T1U170">ndt</span>*<span class="var type1" id="S38T1U171">new_dt</span></span>)</span></span>;    </span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line">  <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line">    <span class="mxinfo" id="T6:U135"><span class="var type1" id="S40T6U175">dvc</span>=<span class="mxinfo" id="T6:U137"><span class="mxinfo" id="T6:U138"><span class="mxinfo" id="T6:U139"><span class="var type1" id="S16T6U179">dVc</span>(<span class="mxinfo" id="T6:U141"><span class="var type1" id="S10T7U181">RC</span>.Cc</span>)</span>.*(<span class="mxinfo" id="T20:U143"><span class="var type1" id="S29T20U185">v1</span>==<span class="mxinfo" id="T1:U145">0</span></span>)</span>+<span class="mxinfo" id="T6:U146"><span class="mxinfo" id="T6:U147"><span class="var type1" id="S16T6U189">dVc</span>(<span class="mxinfo" id="T6:U149"><span class="var type1" id="S10T7U191">RC</span>.Cr</span>)</span>.*<span class="var type1" id="S29T20U193">v1</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line">    <span class="mxinfo" id="T9:U152"><span class="var type1" id="S41T9U196">dvg</span>=<span class="mxinfo" id="T9:U154"><span class="mxinfo" id="T9:U155"><span class="mxinfo" id="T9:U156"><span class="var type1" id="S17T6U200">dVg</span>(<span class="mxinfo" id="T9:U158"><span class="var type1" id="S10T7U202">RC</span>.Gc</span>)</span>.*(<span class="mxinfo" id="T26:U160"><span class="var type1" id="S30T26U206">v2</span>==<span class="mxinfo" id="T1:U162">0</span></span>)</span>+<span class="mxinfo" id="T9:U163"><span class="mxinfo" id="T9:U164"><span class="var type1" id="S17T6U210">dVg</span>(<span class="mxinfo" id="T9:U166"><span class="var type1" id="S10T7U212">RC</span>.Gr</span>)</span>.*<span class="var type1" id="S30T26U214">v2</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line">    <span class="mxinfo" id="T1:U169"><span class="var type1" id="S42T1U217">dt1</span>=<span class="mxinfo" id="T1:U171"><span class="mxinfo" id="T1:U172">1</span>./<span class="mxinfo" id="T1:U173">max(<span class="mxinfo" id="T6:U174">abs(<span class="mxinfo" id="T6:U175">[<span class="mxinfo" id="T6:U176"><span class="mxinfo" id="T6:U177"><span class="var type1" id="S14T6U228">CL</span>.*<span class="var type1" id="S25T6U229">dPc</span></span>./<span class="var type1" id="S40T6U230">dvc</span></span>;<span class="mxinfo" id="T9:U181"><span class="mxinfo" id="T9:U182"><span class="var type1" id="S15T9U234">GL</span>.*<span class="var type1" id="S26T9U235">dPg</span></span>./<span class="var type1" id="S41T9U236">dvg</span></span>]</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line">    <span class="mxinfo" id="T1:U186"><span class="var type1" id="S43T1U239">dt2</span>=<span class="mxinfo" id="T1:U188"><span class="mxinfo" id="T1:U189">1</span>./<span class="mxinfo" id="T1:U190">max(<span class="mxinfo" id="T6:U191">abs(<span class="mxinfo" id="T6:U192">[<span class="mxinfo" id="T6:U193"><span class="mxinfo" id="T6:U194"><span class="var type1" id="S18T6U250">W1C</span>.*<span class="var type1" id="S27T6U251">dPwc</span></span>./<span class="mxinfo" id="T6:U197"><span class="var type1" id="S16T6U253">dVc</span>(<span class="mxinfo" id="T6:U199"><span class="var type1" id="S20T10U255">WoC</span>(:,<span class="mxinfo" id="T1:U201">1</span>)</span>)</span></span>;<span class="mxinfo" id="T6:U202"><span class="mxinfo" id="T6:U203"><span class="var type1" id="S19T6U261">W1G</span>.*<span class="var type1" id="S28T6U262">dPwg</span></span>./<span class="mxinfo" id="T6:U206"><span class="var type1" id="S17T6U264">dVg</span>(<span class="mxinfo" id="T6:U208"><span class="var type1" id="S21T10U266">WoG</span>(:,<span class="mxinfo" id="T1:U210">1</span>)</span>)</span></span>]</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line">    <span class="mxinfo" id="T1:U211"><span class="var type1" id="S44T1U271">ndt1</span>=<span class="mxinfo" id="T1:U213"><span class="var type1" id="S11T1U273">dt</span>/<span class="var type1" id="S42T1U274">dt1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29">29</a></span><span class="line">    <span class="mxinfo" id="T1:U216"><span class="var type1" id="S45T1U277">ndt2</span>=<span class="mxinfo" id="T1:U218"><span class="var type1" id="S11T1U279">dt</span>/<span class="var type1" id="S43T1U280">dt2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30">30</a></span><span class="line">    <span class="mxinfo" id="T1:U221"><span class="var type1" id="S2T1U283">ndt</span>=<span class="mxinfo" id="T1:U223">ceil(<span class="mxinfo" id="T1:U224"><span class="mxinfo" id="T1:U225">max(<span class="mxinfo" id="T25:U226">[<span class="var type1" id="S44T1U291">ndt1</span>;<span class="var type1" id="S45T1U293">ndt2</span>]</span>)</span>*<span class="var type1" id="S23T1U294">Fc</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31">31</a></span><span class="line">  <span class="keyword">end</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32">32</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33">33</a></span><span class="line">   <span class="mxinfo" id="T1:U230"><span class="var type1" id="S2T1U298">ndt</span>=<span class="mxinfo" id="T1:U232">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34">34</a></span><span class="line"><span class="keyword">end</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35">35</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36">36</a></span><span class="line"><span class="mxinfo" id="T1:U233"><span class="var type1" id="S46T1U302">j_old</span>=<span class="var type1" id="S3T1U303">j_ndt</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37">37</a></span><span class="line"><span class="mxinfo" id="T1:U236"><span class="var type1" id="S3T1U306">j_ndt</span>=<span class="mxinfo" id="T1:U238"><span class="var type1" id="S3T1U308">j_ndt</span>+<span class="mxinfo" id="T1:U240"><span class="mxinfo" id="T1:U241">1</span>/<span class="var type1" id="S2T1U311">ndt</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38">38</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39">39</a></span><span class="line"><span class="mxinfo" id="T16:U243"><span class="var type1" id="S4T16U314">fl1</span>=<span class="mxinfo" id="T16:U245"><span class="var type1" id="S3T1U316">j_ndt</span>&lt;<span class="mxinfo" id="T1:U247">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40">40</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41">41</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T16:U248"><span class="var type1" id="S4T16U321">fl1</span>==<span class="mxinfo" id="T1:U250">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42">42</a></span><span class="line">    <span class="mxinfo" id="T1:U251"><span class="var type1" id="S2T1U325">ndt</span>=<span class="mxinfo" id="T1:U253"><span class="mxinfo" id="T1:U254">1</span>/(<span class="mxinfo" id="T1:U255"><span class="mxinfo" id="T1:U256">1</span>-<span class="var type1" id="S46T1U331">j_old</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43">43</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span>;</span></span>
</pre>
