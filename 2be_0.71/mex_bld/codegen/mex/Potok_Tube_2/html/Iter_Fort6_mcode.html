<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40">40</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41">41</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S32T8U215">T</span>=Iter_Fort(<span class="mxinfo" id="T8:U2"><span class="mxinfo" id="T8:U3"><span class="var type1" id="S32T8U218">T</span></span></span>,<span class="var type1" id="S33T8U219">dP</span>,<span class="var type1" id="S34T2U220">mu</span>,<span class="var type1" id="S35T2U221">Ro</span>,<span class="var type1" id="S36T2U222">bet</span>,<span class="var type1" id="S37T8U223">C</span>,<span class="var type1" id="S38T8U224">Kf</span>,<span class="var type1" id="S39T2U225">dt</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42">42</a></span><span class="line"><span class="mxinfo" id="T8:U12"><span class="var type1" id="S40T8U228">t2</span>=<span class="var type1" id="S32T8U229">T</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43">43</a></span><span class="line"><span class="mxinfo" id="T8:U15"><span class="var type1" id="S41T8U232">t0</span>=<span class="var type1" id="S32T8U233">T</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44">44</a></span><span class="line"><span class="mxinfo" id="T2:U18"><span class="var type1" id="S42T2U236">fl</span>=<span class="mxinfo" id="T2:U20">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45">45</a></span><span class="line"><span class="mxinfo" id="T2:U21"><span class="var type1" id="S43T2U240">j</span>=<span class="mxinfo" id="T2:U23">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46">46</a></span><span class="line"><span class="keyword">while</span> <span class="mxinfo" id="T10:U24"><span class="mxinfo" id="T2:U25">(<span class="mxinfo" id="T10:U26"><span class="var type1" id="S42T2U247">fl</span>==<span class="mxinfo" id="T2:U28">0</span></span>)*(<span class="mxinfo" id="T10:U29"><span class="var type1" id="S43T2U251">j</span>&lt;<span class="mxinfo" id="T2:U31">15</span></span>)</span>==<span class="mxinfo" id="T2:U32">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47">47</a></span><span class="line">    <span class="mxinfo" id="T2:U33"><span class="var type1" id="S43T2U256">j</span>=<span class="mxinfo" id="T2:U35"><span class="var type1" id="S43T2U258">j</span>+<span class="mxinfo" id="T2:U37">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48">48</a></span><span class="line">    <span class="mxinfo" id="T8:U38"><span class="var type1" id="S44T8U262">W</span>=<span class="mxinfo" id="T8:U40"><span class="mxinfo" id="T8:U41">abs(<span class="mxinfo" id="T8:U42"><span class="var type1" id="S32T8U267">T</span>.*<span class="var type1" id="S33T8U268">dP</span></span>)</span>*<span class="var type1" id="S39T2U269">dt</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49">49</a></span><span class="line">    <span class="mxinfo" id="T8:U46"><span class="var type1" id="S46T8U272">F</span>=<span class="mxinfo" id="T8:U48"><span class="mxinfo" id="T2:U49">1</span>./(<span class="mxinfo" id="T8:U50"><span class="mxinfo" id="T2:U51">1</span>+<span class="mxinfo" id="T8:U52"><span class="mxinfo" id="T8:U53"><span class="mxinfo" id="T8:U54"><span class="mxinfo" id="T8:U55"><span class="mxinfo" id="T2:U56"><span class="var type1" id="S36T2U283">bet</span>*<span class="var type1" id="S35T2U284">Ro</span></span>*<span class="var type1" id="S38T8U285">Kf</span></span>.*<span class="var type1" id="S37T8U286">C</span></span>.*<span class="var type1" id="S44T8U287">W</span></span>/<span class="var type1" id="S34T2U288">mu</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50">50</a></span><span class="line">    <span class="mxinfo" id="T8:U63"><span class="var type1" id="S32T8U291">T</span>=<span class="mxinfo" id="T8:U65"><span class="var type1" id="S41T8U293">t0</span>.*<span class="var type1" id="S46T8U294">F</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51">51</a></span><span class="line">    <span class="mxinfo" id="T2:U68"><span class="var type1" id="S42T2U297"><span class="message error" id="M3F6C">fl</span></span></span>=<span class="mxinfo" id="T10:U69">all(<span class="mxinfo" id="T18:U70"><span class="mxinfo" id="T6:U71">abs(<span class="mxinfo" id="T6:U72">(<span class="mxinfo" id="T6:U73"><span class="mxinfo" id="T6:U74"><span class="var type1" id="S32T8U307">T</span>(<span class="mxinfo" id="T11:U76"><span class="var type1" id="S41T8U309">t0</span>~=<span class="mxinfo" id="T2:U78">0</span></span>)</span>-<span class="mxinfo" id="T6:U79"><span class="var type1" id="S40T8U312">t2</span>(<span class="mxinfo" id="T11:U81"><span class="var type1" id="S41T8U314">t0</span>~=<span class="mxinfo" id="T2:U83">0</span></span>)</span></span>)./<span class="mxinfo" id="T6:U84"><span class="var type1" id="S32T8U317">T</span>(<span class="mxinfo" id="T11:U86"><span class="var type1" id="S41T8U319">t0</span>~=<span class="mxinfo" id="T2:U88">0</span></span>)</span></span>)</span>&lt;=<span class="mxinfo" id="T2:U89">5e-2</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52">52</a></span><span class="line">    <span class="comment">%   cb(j)=sum(abs(T));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53">53</a></span><span class="line">    <span class="comment">%  cv(j,1)=sum(abs((T(t0~=0)-t2(t0~=0))./T(t0~=0)));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54">54</a></span><span class="line">    <span class="mxinfo" id="T8:U90"><span class="var type1" id="S40T8U324">t2</span>=<span class="var type1" id="S32T8U325">T</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55">55</a></span><span class="line"><span class="keyword">end</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56">56</a></span><span class="line">    <span class="comment">%abs((T(t0~=0)-t2(t0~=0))./T(t0~=0))</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57">57</a></span><span class="line">  <span class="comment">%  full(cv)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58">58</a></span><span class="line"> <span class="comment">%   full(cb)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59">59</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
